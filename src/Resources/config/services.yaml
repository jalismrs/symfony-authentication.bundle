services:
    _defaults:
        public: false
    
    authentication.user_service:
        class: 'Jalismrs\AuthenticationBundle\UserService'
        arguments:
            $stalactiteService: '@authentication.stalactite_service'
    
    Jalismrs\AuthenticationBundle\UserService: '@authentication.user_service'
    
    authentication.stalactite_service:
        class: 'Jalismrs\AuthenticationBundle\StalactiteService'
        arguments:
            $clientApp: '@Jalismrs\Stalactite\Client\Authentication\Model\ClientApp'
            $parser: '@Lcobucci\JWT\Parser'
            $service: '@Jalismrs\Stalactite\Client\Service'
    
    Jalismrs\AuthenticationBundle\StalactiteService: '@authentication.stalactite_service'
    
    authentication.is_authenticated_controller_middleware:
        class: 'Jalismrs\AuthenticationBundle\IsAuthenticatedControllerMiddleware'
        arguments:
            $userService: '@authentication.user_service'
    
    # lcobucci/jwt
    Lcobucci\JWT\Parser:
        autowire: true
    
    # jalismrs/stalactite-api.client
    Jalismrs\Stalactite\Client\Client:
        arguments:
            $host: '%env(STALACTITE_URL)%'
    Jalismrs\Stalactite\Client\Service:
        arguments:
            $client: '@Jalismrs\Stalactite\Client\Client'
    Jalismrs\Stalactite\Client\Authentication\Model\ClientApp:
        autowire: true
